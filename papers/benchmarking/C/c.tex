\chapter{Mass Transport -- C-Processes}

\input{C/theory5}

%=========================================================================
%\section{Reactive transport}

%-------------------------------------------------------------------------
\section{Solute transport with decay}
\label{sec:decay}

\input{C/theory5.1}

\input{C/ex5.1}

%-------------------------------------------------------------------------
\section{Solute transport with sorption}

\input{C/theory5.2}

\subsection{Sorption with linear isotherm (Henry isotherm)}

\input{C/ex5.2.1}

\subsection{Non-linear sorption with Freundlich isotherm}

\input{C/ex5.2.2}

\subsection{Non linear sorption with Langmuir isotherm}

\input{C/ex5.2.3}

%-------------------------------------------------------------------------
\subsection{Solute transport with sorption and decay}

\input{C/ex5.3}

%-------------------------------------------------------------------------
%\subsection{Multi component transport}

%\input{C/ex5.4}

%-------------------------------------------------------------------------
\section{Solute transport by diffusion}

\input{C/theory5.5}

\subsection{Diffusion: axisymmetric model}

\input{C/ex5.5.1}

\subsection{Diffusion in an anisotropic medium (2~D simulation)}

\input{C/ex5.5.2}

\subsection{Solute transport with matrix diffusion}
\subsubsection*{Problem definition}
This benchmark is introduced to verify the matrix diffusion function
developed by Chris McDermott and Georg Kosakowski. It simulates
advective -dispersive transport of a solute in an one-dimensional
fracture with constant aperture, with and without the effect of
matrix-diffusion. The geometry and the material parameters are
chosen to fit the parameters extracted from experiments conducted
during the Colloid Radionuclide Retardation Experiment at Nagra's
Grimsel test site \ref{KosaSmith:2005}. The result from GS/RF is
compared with that from PICNIC, and they fit well.

\subsubsection*{Model set-up of the 1D domain}
\begin{figure}[!htb]
  \begin{center}
    \includegraphics[scale=0.25]{C/figures/fig_matdiff_domain.eps}
  \end{center}
  \caption{Conceptual setup of the 1D problem}
  \label{c:matdiff_dom}
\end{figure}
The geometry and material parameters in PICNIC and GS/RF are
summarized in Table \ref{tab:c_matdiff_setting} and the conceptual
model is shown in Figure \ref{c:matdiff_dom}. PICNIC solves the
one-dimensional problem, whereas in GS/RF a two-dimensional
discretization was chosen. A rectangular domain of 5.2m $\times$
0.5m was discretized with 1155 nodes and 2080 triangular elements.
One of the shorter domain edges was chosen as inflow boundary and
fluid was injected at the boundary-nodes in such a way, that the
resulting fluid velocity matches exactly the value from
\ref{tab:c_matdiff_setting}. The concentration is fixed at the
inflow boundary. In 2.5m distance the breakthrough curve is
recorded. The outflow boundary is assumed to be far away and should
not influence the observed breakthrough curve.Picnic V2.2 and GS/RF
Rev. 1535 from the subversion server were used for testing.

As defining exactly the same transport boundary conditions in GS/RF
and PICNIC is not possible, the following procedure was used to get
the inflow boundary condition as similar as possible:

1) The system was calculated for injecting a pulse of solute with a
constant flux for a time length of 50s with PICNIC. The
concentration vs. time was recorded for the inflow-leg.

2) The concentrations vs. time extracted from PICNIC's inflow-leg
were applied (fixed) to the inflow boundary of the GS/RF system.

These procedures work, as long as advective fluxes are much higher
than the dispersive-diffusive fluxes over the boundary.

The outflow boundary condition is set to infinity, i.e. a
semi-infinite problem is calculated. In GS/RF the domain is set to
5m, double the distance between inflow boundary and observation
point. This prevents the outflow boundary condition to influence the
tracer breakthrough at the observation point.

\begin{table}[H]
  \begin{center}
  \begin{tabular}{llll}
\hline\noalign{\smallskip}
  \hline
 Symbol & Unit & Description & Value \\
  \hline
 $L$ & $m$ & Distance between boundary and observation points & $2.5$ \\
 $\alpha_{T}$ & $m$ & Trans. dispersion (GS/RF only) & $-$ \\
 $\rho$ & $kg/m^{3}$ & Bulk matrix density & $2670$ \\
 $2b$ & $m$ & Fracture aperture & $0.55\times10^{-3}$ \\
 $v$ & $m/s$ & Fluid velocity & $7.05\times10^{-4}$ \\
 $\alpha_{L}$ & $m$ & Long. dispersion (GS/RF only) & $0.1$ \\
 $Pe$ & $-$ & Peclet number (PICNIC only) & $25$ \\
 $\varepsilon_{p}$ & $-$ & Matrix porosity & $0.3$ \\
 $D_{p}$ & $m^{2}/s$ & Diffusion constant in rock matrix & $7.4\times10^{-11}$ \\
  \hline
  \hline
  \end{tabular}
  \caption{Geometry and material properties for the simulations} %\footnotesize
  \label{tab:c_matdiff_setting}
  \end{center}
\end{table}

\subsubsection*{Results}
For the investigated two cases, advection and dispersion(ADE) only
and ADE plus matrix diffusion(MD), the PICNIC and GS/RF solutions
are in general very similar (see Figure \ref{c:matdiff_result}).

\begin{figure}[!htb]
  \begin{center}
  \includegraphics[scale=0.5]{C/figures/fig_matdiff_result.eps}
  \end{center}
  \caption{Breakthrough of the ADE and the ADE+MD solutions calculated with PICNIC and GS/RF}
  \label{c:matdiff_result}
\end{figure}

\begin{tabular}{|l|l|l|}
  \hline
  Benchmark & Problem type & Path in benchmark deposit \\
  \hline
 \emph{matrix\_diffusion} & C & benchmarks\verb \C\matrix_diffusion\OGS_vs_picnic \\
  \hline
\end{tabular}



\subsection{Solute transport with cation exchange}

\input{C/theory5.6}

\input{C/ex5.6}

%-------------------------------------------------------------------------
\subsection{1-D Multi-component transport with dissolution and precipitation}
\subsubsection*{Problem definition}
In this example, a one-dimensional column that initially contains
calcite is continuously flushed by water that contains magnesium
chlorine (Fig. \ref{c:cal_dom}). With the movement of water front,
calcite starts to dissolve and dolomite is formed temporarily.
\begin{figure}[!htb]
  \begin{center}
    \includegraphics[scale=0.5]{C/calcite_domain.eps}
  \end{center}
  \caption{Model domain}
  \label{c:cal_dom}
\end{figure}
\subsubsection*{Media Properties}
The media properties of this model is listed in Table
\ref{tab:c_calcite_mp}.

 \begin{table}[H]
  \begin{center}
  \begin{tabular}{lrl}
\hline\noalign{\smallskip}
  \hline
 Property & Value & Unit \\
  \hline
 Column length & $0.5$ & $m$ \\
 Effective porosity & $0.32$ & $-$ \\
 Bulk density & $1.8\times10^{3}$ & $kg/m^{3}$ \\
 Longitudinal dispersivity & $0.0067$ & $m$ \\
 Pore velocity & $9.375\times10^{-6}$ & $m/sec$ \\
 Flow rate & $3\times10^{-6}$ & $m^{3}/sec$ \\
  \hline
  \hline
  \end{tabular}
  \caption{Material properties} %\footnotesize
  \label{tab:c_calcite_mp}
  \end{center}
  \end{table}

\subsubsection*{Initial and Boundary conditions}
For GS/RF-GEMIPM2K calculation, all the possible chemical species
need to be explicitly set up for initial and boundary conditions. In
this example, all concentration values are given in the unit of
$mol/kg water$. Detailed values can be get from the
*.ic and *.bc files in the corresponding benchmark folder.

\subsubsection*{Results}
This model can be simulated by GS/RF-PHREEQC, GS/RF-ChemApp, and
GS/RF-GEMIPM2K. In these benchmarks, we use the Nagra/PSI
database \cite{PSI_Database:02}, which provides same thermodynamic
data for all three calculations. Fig. \ref{c:cal_rst}
shows the three simulation results. Solid lines are for GS/RF-PHREEQC,
symbols "+" are for GS/RF-GEMIPM2K, and triangles are for GS/RF-ChemApp.

\begin{figure}[!htb]
  \begin{center}
    \includegraphics[scale=0.3]{C/calcite_result.eps}
  \end{center}
  \caption{Benchmark results from GS/RF-ChemApp, GS/RF-PHREEQC, and GS/RF-GEMIPM2K}
  \label{c:cal_rst}
\end{figure}


% \begin{figure}[!htb]
%   \begin{center}
%     \includegraphics[scale=0.3]{C/calcite_result_chemapp.eps}
%   \end{center}
%   \caption{Benchmark results from GS/RF-ChemApp}
%   \label{c:cal_chemapp}
% \end{figure}

\subsubsection*{Benchmark deposit}
\begin{tabular}{|l|l|l|}
  \hline
  Benchmark & Problem type & Path in benchmark deposit \\
  \hline
 \emph{calcite\_gems} & C & benchmarks\verb \C\calcite_gems\ \\
   \hline
 \emph{calcite\_pqc} & C & benchmarks\verb \C\calcite_pqc\ \\
  \hline
 \emph{calcite\_chemapp} & C & benchmarks\verb \C\calcite_ChemApp\ \\
  \hline
\end{tabular}

\section{1D and 2D conservative transport}

\input{C/constrans}
\input{C/hetconstrans}
\input{C/radial_transport}

\section{Reactive Transport}
\input{C/reacttrans}
\input{C/isofrac}
%\input{C/NAPLdiss}


%\section{Biodegradation}

%\subsection{Advective dispersive diffusive transport and zero order kinetic degradation of PCE}
%\subsection{Advection + dispersion + diffusion 1st order kinetic degradation of PCE}
%\subsection{Advective dispersive diffusive transport and 2nd order kinetic degradation}
%\subsection{Advective dispersive diffusive transport and degradation following a Monod kinetic}
%\subsection{Advective dispersive diffusive transport and degradation following a multiplicative Monod kinetic}
%\subsection{Advection + dispersion + 1st order kinetic degradation + linear sorption of Metalaxyl}
%\subsection{Influence of sorption reactions on contaminant transport and degradation rates}
%\subsection{Advective dispersive diffusive transport, degradation and microorganism growth}

%\subsection{Competition of TCE- and cis-DCE-degradation for the zero valent iron surface}
%\subsection{Microbial xylene degradation}
%\subsection{Microbial xylene degradation via sulfate reduction}

\input{C/reactnetwork}

\subsection{Mixing Controlled Bioreactive Transport (2D)}
\input{C/monod2d}
